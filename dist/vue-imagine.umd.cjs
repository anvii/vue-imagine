(function(p,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(p=typeof globalThis<"u"?globalThis:p||self,o(p["vue-imagine"]={},p.Vue))})(this,function(p,o){"use strict";const O=o.defineComponent({__name:"ImageZoomer",props:o.mergeModels({minZoom:{default:.1},maxZoom:{default:10},zoomFactor:{default:1.1},transition:{default:"none"}},{zoom:{default:1},zoomModifiers:{},scrollX:{default:0},scrollXModifiers:{},scrollY:{default:0},scrollYModifiers:{}}),emits:["update:zoom","update:scrollX","update:scrollY"],setup(r,{expose:x}){const s=o.useModel(r,"zoom"),c=o.useModel(r,"scrollX"),i=o.useModel(r,"scrollY"),l=o.computed(()=>{const e=b.value.children[0],{cw:t,ch:n}={cw:e.offsetWidth*s.value,ch:e.offsetHeight*s.value},{rw:f,rh:d}={rw:m.value.clientWidth,rh:m.value.clientHeight},y={left:Math.min(t-f,0),top:Math.min(n-d,0),right:Math.max(t-f,0),bottom:Math.max(n-d,0)};return t<f&&(y.left=y.right=(t-f)/2),n<d&&(y.top=y.bottom=(n-d)/2),y}),m=o.ref({}),b=o.ref({});let w=!1,S=!1;const u={},M={};o.watch(s,e=>{X(e),$(c.value),T(i.value)}),o.watch(c,e=>{$(e)}),o.watch(i,e=>{T(e)});function h(e,t,n){return Math.max(Math.min(e,n),t)}function $(e){c.value=h(e,l.value.left,l.value.right)}function T(e){i.value=h(e,l.value.top,l.value.bottom)}function X(e){s.value=h(e,r.minZoom,r.maxZoom)}function k(e,t){const n=m.value.getBoundingClientRect();return{x:e-Math.round(n.left),y:t-Math.round(n.top)}}function z(e,t,n){return n??(n=s.value),{x:(e+c.value)/n,y:(t+i.value)/n}}function I(e,t,n){return n??(n=s.value),{x:e*n-c.value,y:t*n-i.value}}function a(e,t){g(s.value*r.zoomFactor,e,t)}function v(e,t){g(s.value/r.zoomFactor,e,t)}function g(e,t,n){t??(t=m.value.clientWidth/2),n??(n=m.value.clientHeight/2),e=h(e,r.minZoom,r.maxZoom);const f=z(t,n),d=I(f.x,f.y,e);s.value=e,c.value-=t-d.x,i.value-=n-d.y}function R(e){w&&(c.value=h(c.value-e.movementX,l.value.left,l.value.right),i.value=h(i.value-e.movementY,l.value.top,l.value.bottom),S=!0)}function Y(e){w=e}function V(e){S&&(S=!1,e.stopPropagation())}function P(e){const{x:t,y:n}=k(e.clientX,e.clientY);e.deltaY<0?a(t,n):e.deltaY>0&&v(t,n)}function _(e){for(const t of e.changedTouches){const{identifier:n,clientX:f,clientY:d}=t;u[n]=k(f,d),M[n]={...u[n]}}}function D(e){for(const t of e.changedTouches)delete u[t.identifier],delete M[t.identifier]}function q(e){for(const t of e.changedTouches){const{identifier:n,clientX:f,clientY:d}=t;u[n]=k(f,d)}{const t=parseInt(Object.keys(u)[0]),n=u[t].x-M[t].x,f=u[t].y-M[t].y;c.value-=n,i.value-=f}if(Object.keys(u).length==2){const t=parseInt(Object.keys(u)[0]),n=parseInt(Object.keys(u)[1]),f=E(M[t],M[n]),d=E(u[t],u[n]),y=u[t].x,B=u[t].y;g(s.value*d/f,y,B)}for(const t in u)M[t]={...u[t]}}function E(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function F(e){const t=b.value.children[0],n=m.value.clientWidth/t.offsetWidth,f=m.value.clientHeight/t.offsetHeight;let d=s.value;if(e=="contain")d=Math.min(n,f);else if(e=="cover")d=Math.max(n,f);else{console.error("Invalid fit mode. Possible modes are: contain, cover");return}s.value=d;const y=(m.value.clientWidth-t.offsetWidth*d)/2,B=(m.value.clientHeight-t.offsetHeight*d)/2;c.value=h(-y,l.value.left,l.value.right),i.value=h(-B,l.value.top,l.value.bottom)}return x({zoomIn:a,zoomOut:v,toClient:k,scale:z,unscale:I,fit:F}),(e,t)=>(o.openBlock(),o.createElementBlock("div",{ref_key:"root",ref:m,class:"__image-zoom",style:o.normalizeStyle(`--sx: ${c.value}px; --sy: ${i.value}px; --zoom: ${s.value};`),onDragstart:o.withModifiers(n=>!1,["prevent"]),onMousedown:t[0]||(t[0]=o.withModifiers(n=>Y(!0),["left"])),onMouseup:t[1]||(t[1]=o.withModifiers(n=>Y(!1),["left"])),onMouseleave:t[2]||(t[2]=n=>Y(!1)),onMousemove:R,onWheel:o.withModifiers(P,["prevent"]),onClick:V,onTouchstart:_,onTouchend:D,onTouchcancel:D,onTouchmove:q},[o.createElementVNode("div",{ref_key:"inner",ref:b,class:"__image-zoom-inner",style:o.normalizeStyle(`transition: ${e.transition};`)},[o.renderSlot(e.$slots,"default",{},void 0,!0)],4)],36))}}),W=(r,x)=>{const s=r.__vccOpts||r;for(const[c,i]of x)s[c]=i;return s},Z=W(O,[["__scopeId","data-v-7fd3b0ca"]]),C=.3,H=W(o.defineComponent({__name:"ImageSlider",props:o.mergeModels({disabled:{type:Boolean,default:!1},transition:{default:"none"}},{modelValue:{default:0},modelModifiers:{}}),emits:["update:modelValue"],setup(r,{expose:x}){const s=o.ref(),c=o.ref(),i=o.useModel(r,"modelValue"),l=o.ref(0);let m=!1,b=!1,w=0;o.watch(i,a=>{i.value=S(a,0,c.value.childElementCount-1),l.value=0});function S(a,v,g){return Math.max(Math.min(a,g),v)}function u(){r.disabled||i.value++}function M(){r.disabled||i.value--}function h(){const a=s.value.clientWidth;l.value>=a*C?M():l.value<=-a*C&&u(),l.value=0}function $(a){m=a,a||h()}function T(a){m&&!r.disabled&&(l.value+=a.movementX,b=!0)}function X(a){b&&(a.stopPropagation(),b=!1)}function k(a){w=a.touches[0].clientX,m=!0}function z(){h(),w=0,m=!1}function I(a){r.disabled||(l.value=a.touches[0].clientX-w)}return x({next:u,prev:M}),(a,v)=>(o.openBlock(),o.createElementBlock("div",{ref_key:"root",ref:s,class:"__image-slider",style:o.normalizeStyle(`--slide-index: ${i.value}; --slide-scroll: ${l.value}px;`),onMousedown:v[0]||(v[0]=o.withModifiers(g=>$(!0),["left"])),onMouseup:v[1]||(v[1]=o.withModifiers(g=>$(!1),["left"])),onMouseleave:v[2]||(v[2]=g=>$(!1)),onMousemove:T,onClick:X,onTouchstart:k,onTouchmove:I,onTouchend:z,onTouchcancel:z,onDragstart:o.withModifiers(g=>!1,["prevent"])},[o.createElementVNode("div",{ref_key:"container",ref:c,class:"__container",style:o.normalizeStyle(`transition: ${o.unref(m)?"none":a.transition};`)},[o.renderSlot(a.$slots,"default",{},void 0,!0)],4)],36))}}),[["__scopeId","data-v-c5fa25b5"]]),j=o.defineComponent({__name:"AdaptiveDiv",emits:["update:width","update:height","update:square"],setup(r,{emit:x}){const s=o.ref();let c;const i=x;return o.onMounted(()=>{c=new ResizeObserver(([l])=>{i("update:width",l.contentRect.width),i("update:height",l.contentRect.height),i("update:square",l.contentRect.width*l.contentRect.height)}),c.observe(s.value,{box:"device-pixel-content-box"})}),o.onUnmounted(()=>{c.disconnect()}),(l,m)=>(o.openBlock(),o.createElementBlock("div",{ref_key:"root",ref:s,class:"__adaptive-div"},[o.renderSlot(l.$slots,"default")],512))}});p.AdaptiveDiv=j,p.ImageSlider=H,p.ImageZoomer=Z,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});
